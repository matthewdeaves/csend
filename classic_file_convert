on run	-- Ask user to select source folder	try		set sourceFolder to choose folder with prompt "Select source folder containing .c and .h files:"	on error number -128 -- User cancelled		return	end try		-- Ask user to select destination folder	try		set destFolder to choose folder with prompt "Select destination folder for converted files:"	on error number -128 -- User cancelled		return	end try		-- Get the path string for the destination folder (ends with a colon)	set destFolderPath to destFolder as string		-- Tell the Finder to process the files	tell application "Finder"		try			-- Get list of files in source folder (using alias references is often more robust)			set fileList to files of sourceFolder as alias list						-- Check if any files were found			if (count of fileList) is 0 then				display dialog "No files found in the source folder." buttons {"OK"} default button 1				return			end if						-- Process each file in the source folder			repeat with aFileRef in fileList				set fileName to name of (info for aFileRef) -- Get name from the alias reference								-- Check if file has .c or .h extension				if (fileName ends with ".c") or (fileName ends with ".h") then										-- Construct the full destination file path string					set destFilePath to destFolderPath & fileName										-- Tell BBEdit to perform the open, save, close operation					try						tell application "BBEdit 5.1"							-- Make sure BBEdit is running (optional, tell block usually handles this)							-- activate 														open aFileRef -- Open using the alias reference														save document 1 to destFilePath														-- Close the document without prompting to save again							close document 1 saving no						end tell											on error errMsg number errNum						-- Display an error if BBEdit fails for a specific file, but continue						display dialog "Error processing file: " & fileName & return & return & errMsg & " (Error " & errNum & ")" buttons {"OK"} default button 1 with icon caution					end try									end if			end repeat					on error errMsg number errNum			-- Catch errors during Finder operations (e.g., reading folder contents)			display dialog "Finder error: " & errMsg & " (Error " & errNum & ")" buttons {"OK"} default button 1 with icon stop			return		end try			end tell		display dialog "Processing complete!" buttons {"OK"} default button 1 with icon noteend run